<div class="restaurant-detail-container">
  <div *ngIf="loading" class="loading-spinner">
    <div class="spinner"></div>
    <p>Loading restaurant details...</p>
  </div>
  
  <div *ngIf="!loading && restaurant" class="restaurant-content">
    <!-- Restaurant Header -->
    <div class="restaurant-header" [style.backgroundImage]="'linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url(' + (restaurant.images && restaurant.images.length ? restaurant.images[0] : getDefaultImage()) + ')'">
      <div class="header-content">
        <h1>{{restaurant.name}}</h1>
        
        <div class="restaurant-meta">
          <div class="rating-container">
            <span class="rating-value">{{restaurant.averageRating?.toFixed(1) || 'New'}}</span>
            <app-star-rating [rating]="restaurant.averageRating || 0"></app-star-rating>
            <span class="review-count" *ngIf="restaurant.reviewCount">({{restaurant.reviewCount}} reviews)</span>
          </div>
          
          <div class="price-range">{{restaurant.priceRange}}</div>
          
          <div class="cuisine-types">
            <span *ngFor="let cuisine of restaurant.cuisineType">{{cuisine}}</span>
          </div>
        </div>
        
        <div class="restaurant-actions">
          <button *ngIf="isLoggedIn" class="action-button primary" (click)="toggleReviewForm()">
            Write a Review
          </button>
          <a [href]="'https://maps.google.com/?q=' + restaurant.address + ' ' + restaurant.city + ' ' + restaurant.state" target="_blank" class="action-button secondary">
            Get Directions
          </a>
        </div>
      </div>
    </div>
    
    <!-- Review Form (if toggled) -->
    <div *ngIf="showReviewForm" class="review-form-container">
      <app-review-form 
        [restaurantId]="restaurant.id!" 
        (reviewSubmitted)="onReviewSubmitted($event)"
        (cancelled)="showReviewForm = false"
      ></app-review-form>
    </div>
    
    <!-- Restaurant Tabs -->
    <div class="restaurant-tabs">
      <div class="tab" [class.active]="activeTab === 'overview'" (click)="setActiveTab('overview')">Overview</div>
      <div class="tab" [class.active]="activeTab === 'reviews'" (click)="setActiveTab('reviews')">Reviews</div>
      <div class="tab" [class.active]="activeTab === 'photos'" (click)="setActiveTab('photos')">Photos</div>
    </div>
    
    <!-- Tab Content -->
    <div class="tab-content">
      <!-- Overview Tab -->
      <div *ngIf="activeTab === 'overview'" class="overview-tab">
        <div class="info-section">
          <h2>About</h2>
          <p>{{restaurant.description}}</p>
        </div>
        
        <div class="info-grid">
          <div class="info-card">
            <h3>Location</h3>
            <p>{{restaurant.address}}</p>
            <p>{{restaurant.city}}, {{restaurant.state}} {{restaurant.zipCode}}</p>
          </div>
          
          <div class="info-card">
            <h3>Contact</h3>
            <p>Phone: {{restaurant.phone}}</p>
            <p *ngIf="restaurant.email">Email: {{restaurant.email}}</p>
            <p *ngIf="restaurant.website">Website: <a [href]="restaurant.website" target="_blank">{{restaurant.website}}</a></p>
          </div>
          
          <div class="info-card">
            <h3>Hours</h3>
            <p>Today: {{getOpeningHoursForToday()}}</p>
            <div class="hours-list">
              <div *ngIf="restaurant.openingHours.monday">Monday: {{restaurant.openingHours.monday}}</div>
              <div *ngIf="restaurant.openingHours.tuesday">Tuesday: {{restaurant.openingHours.tuesday}}</div>
              <div *ngIf="restaurant.openingHours.wednesday">Wednesday: {{restaurant.openingHours.wednesday}}</div>
              <div *ngIf="restaurant.openingHours.thursday">Thursday: {{restaurant.openingHours.thursday}}</div>
              <div *ngIf="restaurant.openingHours.friday">Friday: {{restaurant.openingHours.friday}}</div>
              <div *ngIf="restaurant.openingHours.saturday">Saturday: {{restaurant.openingHours.saturday}}</div>
              <div *ngIf="restaurant.openingHours.sunday">Sunday: {{restaurant.openingHours.sunday}}</div>
            </div>
          </div>
        </div>
        
        <!-- Similar Restaurants -->
        <div class="similar-restaurants-section">
          <h2>Similar Restaurants You Might Like</h2>
          
          <div *ngIf="similarLoading" class="loading-spinner small">
            <div class="spinner"></div>
            <p>Loading recommendations...</p>
          </div>
          
          <div *ngIf="!similarLoading && similarRestaurants.length === 0" class="no-results">
            <p>No similar restaurants found.</p>
          </div>
          
          <div *ngIf="!similarLoading && similarRestaurants.length > 0" class="similar-restaurants-grid">
            <app-restaurant-card 
              *ngFor="let similarRestaurant of similarRestaurants" 
              [restaurant]="similarRestaurant"
            ></app-restaurant-card>
          </div>
        </div>
      </div>
      
      <!-- Reviews Tab -->
      <div *ngIf="activeTab === 'reviews'" class="reviews-tab">
        <div class="reviews-header">
          <h2>Customer Reviews</h2>
          <button *ngIf="isLoggedIn" class="write-review-button" (click)="toggleReviewForm()">
            Write a Review
          </button>
        </div>
        
        <div *ngIf="reviewsLoading" class="loading-spinner small">
          <div class="spinner"></div>
          <p>Loading reviews...</p>
        </div>
        
        <div *ngIf="!reviewsLoading && reviews.length === 0" class="no-results">
          <p>No reviews yet. Be the first to review this restaurant!</p>
        </div>
        
        <app-review-list 
          *ngIf="!reviewsLoading && reviews.length > 0" 
          [reviews]="reviews"
        ></app-review-list>
      </div>
      
      <!-- Photos Tab -->
      <div *ngIf="activeTab === 'photos'" class="photos-tab">
        <h2>Restaurant Photos</h2>
        
        <div *ngIf="!restaurant.images || restaurant.images.length === 0" class="no-results">
          <p>No photos available for this restaurant.</p>
        </div>
        
        <div *ngIf="restaurant.images && restaurant.images.length > 0" class="photos-grid">
          <div *ngFor="let image of restaurant.images" class="photo-item">
            <img [src]="image" [alt]="restaurant.name">
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div *ngIf="!loading && !restaurant" class="not-found">
    <h2>Restaurant Not Found</h2>
    <p>The restaurant you're looking for doesn't exist or has been removed.</p>
    <a routerLink="/restaurants" class="back-button">Back to Restaurants</a>
  </div>
</div>
